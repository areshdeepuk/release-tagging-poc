name: Deploy to QA

on:
  workflow_run:
    workflows: ["Deploy to DEV"]
    types:
      - completed

jobs:
  Deploy_QA:
    if: ${{ github.event.workflow_run.conclusion == 'success' }}
    runs-on: ubuntu-latest
    steps:
      - name: Download deploy status artifact
        uses: actions/download-artifact@v3
        with:
          name: deploy-status
          path: deploy-status.txt
      - name: Download release status artifact
        uses: actions/download-artifact@v3
        with:
          name: release-status
          path: release-status.txt
      - name: Check job statuses
        id: check_status
        run: |
          deploy_status=$(cat deploy-status.txt)
          echo "Deploy status: $deploy_status"

          release_status=$(cat release-status.txt)
          echo "release status: $release_status"

          if [[ "$deploy_status" == "skipped" || "$release_status" == "skipped"]]; then
            echo "Some jobs were skipped"
            exit 1
          else
            echo "No jobs were skipped"
          fi
      - name: Deployment step
        if: success()
        run: echo "Deploying to qa..."
      - name: Deployment step
        if: success()
        run: echo "Health check for QA..."
          
